"use strict";(()=>{var G=Object.defineProperty;var c=(P,N)=>G(P,"name",{value:N,configurable:!0});(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["scanning"],{56153:(P,N,S)=>{S.d(N,{P:()=>h,D:()=>C});function h(k,L=0,{start:T=!0,middle:M=!0,once:I=!1}={}){let x=0,y,j=!1;function E(...w){if(j)return;const A=Date.now()-x;x=Date.now(),T?(T=!1,k.apply(this,w),I&&E.cancel()):(M&&A<L||!M)&&(clearTimeout(y),y=setTimeout(()=>{x=Date.now(),k.apply(this,w),I&&E.cancel()},M?L-A:L))}return c(E,"fn"),E.cancel=()=>{clearTimeout(y),j=!0},E}c(h,"throttle");function C(k,L=0,{start:T=!1,middle:M=!1,once:I=!1}={}){return h(k,L,{start:T,middle:M,once:I})}c(C,"debounce")},11427:(P,N,S)=>{S.d(N,{f:()=>f,on:()=>u});function h(){if(!(this instanceof h))return new h;this.size=0,this.uid=0,this.selectors=[],this.selectorObjects={},this.indexes=Object.create(this.indexes),this.activeIndexes=[]}c(h,"SelectorSet");var C=window.document.documentElement,k=C.matches||C.webkitMatchesSelector||C.mozMatchesSelector||C.oMatchesSelector||C.msMatchesSelector;h.prototype.matchesSelector=function(e,t){return k.call(e,t)},h.prototype.querySelectorAll=function(e,t){return t.querySelectorAll(e)},h.prototype.indexes=[];var L=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;h.prototype.indexes.push({name:"ID",selector:c(function(t){var n;if(n=t.match(L))return n[0].slice(1)},"matchIdSelector"),element:c(function(t){if(t.id)return[t.id]},"getElementId")});var T=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;h.prototype.indexes.push({name:"CLASS",selector:c(function(t){var n;if(n=t.match(T))return n[0].slice(1)},"matchClassSelector"),element:c(function(t){var n=t.className;if(n){if(typeof n=="string")return n.split(/\s/);if(typeof n=="object"&&"baseVal"in n)return n.baseVal.split(/\s/)}},"getElementClassNames")});var M=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;h.prototype.indexes.push({name:"TAG",selector:c(function(t){var n;if(n=t.match(M))return n[0].toUpperCase()},"matchTagSelector"),element:c(function(t){return[t.nodeName.toUpperCase()]},"getElementTagName")}),h.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}};var I;typeof window.Map=="function"?I=window.Map:I=function(){function e(){this.map={}}return c(e,"Map"),e.prototype.get=function(t){return this.map[t+" "]},e.prototype.set=function(t,n){this.map[t+" "]=n},e}();var x=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;function y(e,t){e=e.slice(0).concat(e.default);var n=e.length,l,d,m,a,p=t,g,v,b=[];do if(x.exec(""),(m=x.exec(p))&&(p=m[3],m[2]||!p)){for(l=0;l<n;l++)if(v=e[l],g=v.selector(m[1])){for(d=b.length,a=!1;d--;)if(b[d].index===v&&b[d].key===g){a=!0;break}a||b.push({index:v,key:g});break}}while(m);return b}c(y,"parseSelectorIndexes");function j(e,t){var n,l,d;for(n=0,l=e.length;n<l;n++)if(d=e[n],t.isPrototypeOf(d))return d}c(j,"findByPrototype"),h.prototype.logDefaultIndexUsed=function(){},h.prototype.add=function(e,t){var n,l,d,m,a,p,g,v,b=this.activeIndexes,_=this.selectors,F=this.selectorObjects;if(typeof e=="string"){for(n={id:this.uid++,selector:e,data:t},F[n.id]=n,g=y(this.indexes,e),l=0;l<g.length;l++)v=g[l],m=v.key,d=v.index,a=j(b,d),a||(a=Object.create(d),a.map=new I,b.push(a)),d===this.indexes.default&&this.logDefaultIndexUsed(n),p=a.map.get(m),p||(p=[],a.map.set(m,p)),p.push(n);this.size++,_.push(e)}},h.prototype.remove=function(e,t){if(typeof e=="string"){var n,l,d,m,a,p,g,v,b=this.activeIndexes,_=this.selectors=[],F=this.selectorObjects,B={},z=arguments.length===1;for(n=y(this.indexes,e),d=0;d<n.length;d++)for(l=n[d],m=b.length;m--;)if(p=b[m],l.index.isPrototypeOf(p)){if(g=p.map.get(l.key),g)for(a=g.length;a--;)v=g[a],v.selector===e&&(z||v.data===t)&&(g.splice(a,1),B[v.id]=!0);break}for(d in B)delete F[d],this.size--;for(d in F)_.push(F[d].selector)}};function E(e,t){return e.id-t.id}c(E,"sortById"),h.prototype.queryAll=function(e){if(!this.selectors.length)return[];var t={},n=[],l=this.querySelectorAll(this.selectors.join(", "),e),d,m,a,p,g,v,b,_;for(d=0,a=l.length;d<a;d++)for(g=l[d],v=this.matches(g),m=0,p=v.length;m<p;m++)_=v[m],t[_.id]?b=t[_.id]:(b={id:_.id,selector:_.selector,data:_.data,elements:[]},t[_.id]=b,n.push(b)),b.elements.push(g);return n.sort(E)},h.prototype.matches=function(e){if(!e)return[];var t,n,l,d,m,a,p,g,v,b,_,F=this.activeIndexes,B={},z=[];for(t=0,d=F.length;t<d;t++)if(p=F[t],g=p.element(e),g){for(n=0,m=g.length;n<m;n++)if(v=p.map.get(g[n]))for(l=0,a=v.length;l<a;l++)b=v[l],_=b.id,!B[_]&&this.matchesSelector(e,b.selector)&&(B[_]=!0,z.push(b))}return z.sort(E)};var w={},A={},q=new WeakMap,H=new WeakMap,D=new WeakMap,O=Object.getOwnPropertyDescriptor(Event.prototype,"currentTarget");function R(e,t,n){var l=e[t];return e[t]=function(){return n.apply(e,arguments),l.apply(e,arguments)},e}c(R,"before");function U(e,t,n){var l=[],d=t;do{if(d.nodeType!==1)break;var m=e.matches(d);if(m.length){var a={node:d,observers:m};n?l.unshift(a):l.push(a)}}while(d=d.parentElement);return l}c(U,"dist_matches");function $(){q.set(this,!0)}c($,"trackPropagation");function V(){q.set(this,!0),H.set(this,!0)}c(V,"trackImmediate");function W(){return D.get(this)||null}c(W,"getCurrentTarget");function r(e,t){!O||Object.defineProperty(e,"currentTarget",{configurable:!0,enumerable:!0,get:t||O.get})}c(r,"defineCurrentTarget");function o(e){try{return e.eventPhase,!0}catch{return!1}}c(o,"canDispatch");function s(e){if(!!o(e)){var t=e.eventPhase===1?A:w,n=t[e.type];if(!!n){var l=U(n,e.target,e.eventPhase===1);if(!!l.length){R(e,"stopPropagation",$),R(e,"stopImmediatePropagation",V),r(e,W);for(var d=0,m=l.length;d<m&&!q.get(e);d++){var a=l[d];D.set(e,a.node);for(var p=0,g=a.observers.length;p<g&&!H.get(e);p++)a.observers[p].data.call(a.node,e)}D.delete(e),r(e)}}}}c(s,"dispatch");function u(e,t,n){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},d=!!l.capture,m=d?A:w,a=m[e];a||(a=new h,m[e]=a,document.addEventListener(e,s,d)),a.add(t,n)}c(u,"on");function i(e,t,n){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},d=!!l.capture,m=d?A:w,a=m[e];!a||(a.remove(t,n),!a.size&&(delete m[e],document.removeEventListener(e,s,d)))}c(i,"off");function f(e,t,n){return e.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n}))}c(f,"fire")},66123:(P,N,S)=>{S.d(N,{ZG:()=>T,w4:()=>M,q6:()=>I});var h=S(22593);let C=!1;const k=new h.Z;function L(x){const y=x.target;if(y instanceof HTMLElement&&y.nodeType!==Node.DOCUMENT_NODE)for(const j of k.matches(y))j.data.call(null,y)}c(L,"handleFocus");function T(x,y){C||(C=!0,document.addEventListener("focus",L,!0)),k.add(x,y),document.activeElement instanceof HTMLElement&&document.activeElement.matches(x)&&y(document.activeElement)}c(T,"onFocus");function M(x,y,j){function E(w){const A=w.currentTarget;!A||(A.removeEventListener(x,j),A.removeEventListener("blur",E))}c(E,"blurHandler"),T(y,function(w){w.addEventListener(x,j),w.addEventListener("blur",E)})}c(M,"onKey");function I(x,y){function j(E){const{currentTarget:w}=E;!w||(w.removeEventListener("input",y),w.removeEventListener("blur",j))}c(j,"blurHandler"),T(x,function(E){E.addEventListener("input",y),E.addEventListener("blur",j)})}c(I,"onInput")},45447:(P,N,S)=>{var h=S(11427);function C(r){const o=document.createElement("input");return o.setAttribute("type","hidden"),o.setAttribute("name",r.name),o.setAttribute("value",r.value),o}c(C,"copyInput");function k(r){let o=!1;const s=r.querySelectorAll(".js-scanning-fixed-alert-numbers"),u=s.length!==0?JSON.parse(s[0].getAttribute("data-numbers")||"[]"):[];for(const i of r.querySelectorAll(".js-scanning-bulk-action-items")){i.innerHTML="";const f=r.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const e of f)o||(o=u.indexOf(parseInt(e.value))!==-1),i.appendChild(C(e))}for(const i of r.querySelectorAll(".js-scanning-reopen-button"))i.hidden=o;for(const i of r.querySelectorAll(".js-scanning-reopen-button-disabled"))i.hidden=!o}c(k,"copyCheckedAlertsToBulkActionForms"),(0,h.on)("change",".js-scanning-alert-check",function({currentTarget:r}){const o=r.closest(".js-scanning-alert-list"),s=o.querySelector(".js-scanning-alert-check:checked")!=null,u=o.querySelector(".js-scanning-filter-options"),i=o.querySelector(".js-scanning-alert-bulk-actions"),f=o.querySelector(".js-scanning-alert-links");u&&(u.hidden=s),i&&(i.hidden=!s),f&&(f.hidden=s),k(o)}),(0,h.on)("details-menu-selected",".js-scanning-code-path-menu",function(r){const o=r.detail.relatedTarget.getAttribute("data-target-code-path");for(const s of document.querySelectorAll(".js-scanning-code-path"))s.hidden=o!==s.getAttribute("data-code-path")},{capture:!0});var L=S(56153),T=S(30762),M=S(66123);(0,T.N7)(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;const r=document.querySelector(".js-post-processing-expression-count");r&&r.textContent&&(window.postProcessingExpressionCount=parseInt(r.textContent))}}),(0,h.on)("click",".js-add-secret-format-button",r=>{const o=r.currentTarget;if(!!o&&window.postProcessingExpressionCount<D()){const s=document.querySelectorAll(".js-additional-secret-format");if(!s)return;for(const u of s)if(u.classList.contains("has-removed-contents")){u.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===D()&&(o.hidden=!0);break}}}),(0,h.on)("click",".js-remove-secret-format-button",r=>{var o,s;const u=document.querySelector(".js-add-secret-format-button");if(!u)return;const i=r.currentTarget;if(!i)return;const f=i.closest(".js-additional-secret-format");if(!f)return;f.classList.toggle("has-removed-contents",!0);const e=f.getElementsByClassName("js-post-processing-input")[0];e.value="";const t=Array.from(f.getElementsByClassName("js-post-processing-input-rule")),n=f.getElementsByClassName("errored")[0];n&&n.classList.toggle("errored",!1);for(const l of t)(o=document.getElementById(`${l.id}_hidden`))==null||o.remove();(s=document.getElementById(`${e.id}_hidden`))==null||s.remove(),E(window.codeEditor.getValue()),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<D()&&(u.hidden=!1)}),(0,T.N7)(".js-test-code",{async add(){const r=document.querySelector(".js-test-code"),o=r.clientHeight,s=await S.e("vendors-node_modules_codemirror_lib_codemirror_js").then(S.t.bind(S,27509,23));if(window.codeEditor=s.default.fromTextArea(r,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:r.value,lineSeparator:`\r
`,theme:"github-light"}),o!==0){const u=document.querySelector(".CodeMirror");u&&(u.style.height=`${o}px`,u.style.border="1px solid #e1e4e8",u.style.borderRadius="6px")}window.codeEditor.save(),window.codeEditor.on("change",()=>{E(window.codeEditor.getValue())})}}),(0,M.q6)(".js-custom-secret-scanning-pattern-form *",async function(){!window.codeEditor||E(window.codeEditor.getValue())}),(0,h.on)("click",".js-save-and-dry-run-button, .js-custom-pattern-submit-button",r=>{r.preventDefault();const o=I(r);if(!o)return;x(o);const s=y();!s||(o.className.includes("js-save-and-dry-run-button")&&j(s,"submit_type","save_and_dry_run"),(0,h.f)(s,"submit"))});function I(r){return r.currentTarget}c(I,"getSubmitButton");function x(r){r.innerHTML=r.getAttribute("data-disable-with")||"",r.disabled=!0}c(x,"setSubmitButtonDisableWith");function y(){return document.querySelector(".js-custom-secret-scanning-pattern-form")}c(y,"getCustomPatternForm");const j=c((r,o,s)=>{const u=document.createElement("input");u.type="hidden",u.name=o,u.id=`${o}_hidden`,u.value=s,r.appendChild(u),u.required=!0},"createHiddenInputField"),E=(0,L.D)(function(r){const o=document.querySelector(".js-custom-pattern-submit-button"),s=document.querySelector(".js-save-and-dry-run-button");if(!(o instanceof HTMLElement))return;const u=document.querySelector(".js-update-pattern-info"),i=document.querySelector(".js-test-pattern-matches");if(!!i)if(r.length===0){const f=document.querySelector(".js-dry-run-status");if(!f)return;$(f)||o.setAttribute("disabled","true"),s==null||s.setAttribute("disabled","true"),i.textContent=""}else{window.codeEditor.save();const f=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(f instanceof HTMLFormElement))return;const e=y();if(!e)return;for(const t of e.elements)if(t instanceof HTMLInputElement&&t.name&&(t.type==="text"||t.type==="radio"&&t.checked)){const n=document.getElementById(`${t.name}_hidden`);n!==null&&n.remove(),j(f,t.name,t.value)}W(f,A(e,o,s,u),w(i))}},300),w=c(r=>o=>{if(o.length===0)r.textContent=" - No matches";else if(o.length===1)r.textContent=" - 1 match";else{const s=[];for(const f of o)s.push(JSON.stringify(f));const i=[...new Set(s)];r.textContent=` - ${i.length} matches`}},"getTestLabelUpdater"),A=c((r,o,s,u)=>i=>{var f,e,t;if(H(r),i==null?void 0:i.message){if(o.setAttribute("disabled","true"),s==null||s.setAttribute("disabled","true"),u)u.hidden=!0;else if((i==null?void 0:i.error_type)==="START_DELIMITER"||(i==null?void 0:i.error_type)==="END_DELIMITER"||(i==null?void 0:i.error_type)==="MUST_MATCH"||(i==null?void 0:i.error_type)==="MUST_NOT_MATCH"){const n=document.querySelector(".js-more-options.js-details-container");n&&(n.classList.add("open"),n.classList.add("Details--on"))}return q(r,i),!1}else{const n=document.querySelector(".js-mode");if(!n)return!1;const l=document.querySelector(".js-dry-run-status");return l?((((f=l.textContent)==null?void 0:f.toLowerCase())==="cancelled"||((e=l.textContent)==null?void 0:e.toLowerCase())==="skipped"||((t=n.textContent)==null?void 0:t.toLowerCase())!=="unpublished")&&o.removeAttribute("disabled"),s==null||s.removeAttribute("disabled"),u&&(u.hidden=!1),!0):!1}},"getTestErrorHandler");function q(r,o){var s;if(o.error_type==="MUST_MATCH"||o.error_type==="MUST_NOT_MATCH"){let u=0;const i=r.getElementsByClassName("js-additional-secret-format");for(const f of i){if(u>(o.error_index||0))return;const t=[...f.getElementsByTagName("input")].filter(p=>p.checked),n=t&&((s=t[0])==null?void 0:s.value.toUpperCase()),l=n===o.error_type&&u===o.error_index,m=[...f.getElementsByTagName("input")].filter(p=>p.type==="text");if(!m||m.length===0)continue;const a=m[0];if(a.value!=="")if(l){const p=a.id;a&&a.parentElement&&O(a.parentElement);const g=document.createElement("p"),v=`${p}_error_message`;g.classList.add("note","error","mt-5"),g.id=v,g.textContent=o.message,a==null||a.setAttribute("aria-describedby",v),a==null||a.insertAdjacentElement("afterend",g);return}else n===o.error_type&&u++}}else{const u=V[o.error_type],i=document.querySelector(`#${u}`);i&&i.parentElement&&O(i.parentElement);const f=document.createElement("p"),e=`${u}_error_message`;f.classList.add("note","error"),f.id=e,f.textContent=o.message,i==null||i.setAttribute("aria-describedby",e),i==null||i.insertAdjacentElement("afterend",f)}}c(q,"showInputErrorState");function H(r){var o,s;const u=document.querySelector(".js-error-banner");u.hidden=!0;for(const i of r.getElementsByTagName("input"))if((o=i.parentElement)==null?void 0:o.classList.contains("errored")){R(i.parentElement);const f=i.getAttribute("aria-describedby");(s=document.querySelector(`#${f}`))==null||s.remove()}}c(H,"clearInputErrorState");function D(){const r=document.querySelector(".js-post-processing-expression-max-count");if(!r)return 5;const o=r.textContent;return o?parseInt(o):5}c(D,"getMaxPostProcessingExpressions");function O(r){r==null||r.classList.add("form-group","errored","my-0")}c(O,"addErrorStylingToInput");function R(r){r==null||r.classList.remove("form-group","errored","my-0")}c(R,"removeErrorStylingFromInput");function U(){if(!window.codeEditor)return;const r=window.codeEditor.posFromIndex(0),o=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const s of window.codeEditor.findMarks(r,o))s.clear()}c(U,"clearCodeHighlights");function $(r){var o,s;return((o=r.textContent)==null?void 0:o.toLowerCase())==="queued"||((s=r.textContent)==null?void 0:s.toLowerCase())==="inprogress"}c($,"allowDryRunCancellation");const V={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function W(r,o,s){let u;try{const i=await fetch(r.action,{method:r.method,body:new FormData(r),headers:{Accept:"application/json"}});i.ok&&(u=await i.json())}catch{}if(u&&o(u.error))if(u.has_matches){const i=JSON.parse(u.matches);U(),s(i);for(const f of i){const e=window.codeEditor.posFromIndex(f.start),t=window.codeEditor.posFromIndex(f.end);window.codeEditor.markText(e,t,{className:"text-bold hx_keyword-hl rounded-2 d-inline-block"})}}else s([]),U()}c(W,"updatePatternMatches")}},P=>{var N=c(h=>P(P.s=h),"__webpack_exec__");P.O(0,["vendors-node_modules_selector-observer_dist_index_esm_js"],()=>N(45447));var S=P.O()}]);})();

//# sourceMappingURL=scanning-e004ea472ce78c194b1aacd6b8c79e1a6a388384767068445ca2d62d354ce0ef74ab5ca93cef68214f956af5038af964cb28c346bd538fe727308042ff1ab8a0.js.map